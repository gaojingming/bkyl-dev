<extend name="Public:base" />

<block name="css">
  <link href="__PUBLIC__/plugins/datatables/dataTables.bootstrap.css" rel="stylesheet" type="text/css" />
</block>

<block name="content">
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1 class="font-yh">文章管理</h1>
    </section>

    <section class="content">
      <div class="row">
        <div class="col-xs-12">
          <div class="box">
              <div class="box-header with-border">
                <h3 class="box-title font-yh">添加文章</h3>
              </div>
              <div class="box-body">
                <div class="row">
                  <form id="category_change" action="" method="get">
                    <div class="form-group col-md-3 col-xs-12">
                      <label>选择分类</label>
                      <select id="category_select" class="form-control" name="category_select">
                        <option style="display:none">请选择文章分类</option>
                      </select>
                    </div>
                  </form>
                  <!-- /category_change -->
                </div>
                <table id="article_list" class="table table-bordered table-hover"></table>
              </div>
              <!-- /box-body -->
          </div>
          <!-- /box -->
        </div>
        <!-- /col -->
      </div>
    </section>
    <!-- /content -->
  </div><!-- /.content-wrapper -->
</block>

<block name="loadjs">
  <include file="Public:set_sidebar" firstdir="文章管理" seconddir="添加新文章" />

  <script type="text/javascript">
    $(document).ready(function() { 
      $.ajax({
        type: 'get',
        url: "{:U('Category/get_category')}",
        dataType: 'json',
        success: function(data) {
          for (var i = 0; i < data.length; ++ i) {
            $('#category_select').append('<option value="' + data[i].id + '">' + data[i].name + '</option>');
          }

          var category_id = $_GET['category_id'];
          if (category_id != undefined)
            $('option[value=' + category_id + ']').attr('selected', 'selected');
        },
        error: function(error) {
          console.log(error);
        }
      });
    });
  </script>
</block>